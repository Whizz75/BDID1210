<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Financial Records</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #f1f1f1;
        }

        .section-header {
            background-color: #004080;
            color: white;
            font-weight: bold;
            text-align: left;
            padding-left: 10px;
        }

        .category-row {
            background-color: #f9f9f9;
            font-weight: bold;
            text-align: left;
            padding-left: 10px;
        }
    </style>
</head>
<body>

<h1>Financial Records</h1>

<table id="financial-table">
    <thead>
        <tr>
            <th>Financial Statements</th>
            <th>2020</th>
            <th>2021</th>
            <th>2022</th>
            <th>2023</th>
            <th>2024</th>
        </tr>
    </thead>
    <tbody>
        <!-- Dynamic rows will be inserted here -->
    </tbody>
</table>

<script>
    async function loadFinancialData() {
        try {
            const response = await fetch('http://localhost:5000/records');
            const data = await response.json();

            // Create a year-to-record mapping for easier access
            const yearMap = {};
            data.forEach(record => {
                yearMap[record.Year] = record;
            });

            const tbody = document.querySelector('#financial-table tbody');

            // ========== Income Statement Section ==========
            tbody.innerHTML += `<tr><td colspan="6" class="section-header">Income Statement</td></tr>`;
            tbody.innerHTML += createRow('Revenue', yearMap, 'IncomeStatement', 'Revenue');
            tbody.innerHTML += createRow('Cost of Goods Sold', yearMap, 'IncomeStatement', 'CostOfGoodsSold');
            tbody.innerHTML += createRow('Gross Profit', yearMap, 'IncomeStatement', 'GrossProfit');
            tbody.innerHTML += createRow('Total Expenses', yearMap, 'IncomeStatement', 'TotalExpenses');
            tbody.innerHTML += createRow('Earnings Before Tax', yearMap, 'IncomeStatement', 'EarningsBeforeTax');
            tbody.innerHTML += createRow('Taxes', yearMap, 'IncomeStatement', 'Taxes');
            tbody.innerHTML += createRow('Net Profit', yearMap, 'IncomeStatement', 'NetProfit');

            // ========== Balance Sheet Section ==========
            tbody.innerHTML += `<tr><td colspan="6" class="section-header">Balance Sheet</td></tr>`;
            tbody.innerHTML += createRow('Cash', yearMap, 'BalanceSheet', 'Cash');
            tbody.innerHTML += createRow('Debt', yearMap, 'BalanceSheet', 'Debt');
            tbody.innerHTML += createRow('Equity Capital', yearMap, 'BalanceSheet', 'EquityCapital');
            tbody.innerHTML += createRow('Retained Earnings', yearMap, 'BalanceSheet', 'RetainedEarnings');
            tbody.innerHTML += createRow('Total Shareholders Equity', yearMap, 'BalanceSheet', 'TotalShareholdersEquity');

            // ========== Cash Flow Statement Section ==========
            tbody.innerHTML += `<tr><td colspan="6" class="section-header">Cash Flow Statement</td></tr>`;
            tbody.innerHTML += createRow('Net Earnings', yearMap, 'CashFlowStatement', 'NetEarnings');
            tbody.innerHTML += createRow('Cash from Operations', yearMap, 'CashFlowStatement', 'CashFromOperations');
            tbody.innerHTML += createRow('Investment in Property & Equipment', yearMap, 'CashFlowStatement', 'InvestmentInPropertyAndEquipment');
            tbody.innerHTML += createRow('Cash from Investing', yearMap, 'CashFlowStatement', 'CashFromInvesting');
            tbody.innerHTML += createRow('Net Cash Change', yearMap, 'CashFlowStatement', 'NetCashChange');
            tbody.innerHTML += createRow('Opening Cash Balance', yearMap, 'CashFlowStatement', 'OpeningCashBalance');
            tbody.innerHTML += createRow('Closing Cash Balance', yearMap, 'CashFlowStatement', 'ClosingCashBalance');

        } catch (error) {
            console.error("Error fetching financial data:", error);
        }
    }

    function createRow(label, yearMap, section, field) {
        let row = `<tr><td class="category-row">${label}</td>`;
        for (let year = 2020; year <= 2024; year++) {
            const value = yearMap[year]?.[section]?.[field];
            row += `<td>${value !== undefined ? value : '-'}</td>`;
        }
        row += `</tr>`;
        return row;
    }

    loadFinancialData();
</script>

</body>
</html>
